#!/usr/bin/env bash

# -----------------------------------------------------------------------------
# external_monitor
# Description: enables or disables external monitor with given args
# -----------------------------------------------------------------------------
# Useage:      $ ./external_monitor
# -----------------------------------------------------------------------------

readonly primary_monitor='eDP-1'
primary_monitor_args=( '--mode' '2880x1800' )

readonly external_monitor='HDMI-3'
external_monitor_args=( '--mode' '1920x1080' '--rotate' 'left' '--right-of' "${primary_monitor}" )

function enable_external_monitor() {
    xrandr --output "${primary_monitor}" "${primary_monitor_args[@]}" --primary
    xrandr --output "${external_monitor}" "${external_monitor_args[@]}"
}

function disable_external_monitor() {
    xrandr --output "${primary_monitor}" "${primary_monitor_args[@]}" --primary
    xrandr --output "${external_monitor}" --off
}

function main() {
    local external_monitor_status=$(xrandr --query | grep "${external_monitor} connected")

    # check if $monitor_external is connected
    if [[ -z "${external_monitor_status}" ]]; then
        exit 1
    fi

    case $1 in
        # add current song to target file
        "enable")
        enable_external_monitor
        ;;
        # remove current song from target file
        "disable")
        disable_external_monitor
        ;;
        # incorrect syntax
        *)
        echo 'Incorrect usage: monitor {enable/disable}' >&2
        exit 2
        ;;
    esac
}

main "$@"
