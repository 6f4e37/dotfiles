#!/usr/bin/env bash

# -----------------------------------------------------------------------------
# sf
# Description: Displays arch system information
# -----------------------------------------------------------------------------
# Source:
#   onodera-punpun: https://github.com/onodera-punpun/dotfiles
# -----------------------------------------------------------------------------
# Useage:      $ sh ./sf
# -----------------------------------------------------------------------------

# Define colors
c0=$(tput setaf 0)  # black
c1=$(tput setaf 1)  # red
c2=$(tput setaf 2)  # green
c3=$(tput setaf 3)  # yellow
c4=$(tput setaf 4)  # blue
c5=$(tput setaf 5)  # magenta
c6=$(tput setaf 6)  # cyan
c7=$(tput setaf 7)  # white
bc=$(tput bold)     # bold
rc=$(tput sgr0)     # reset

# common wms
wms=( "2bwm" "awesome" "blackbox" "bspwm" "cwm" "dwm" "fluxbox" "herbstluftwm" "i3" \
    "monsterwm" "openbox" "ratpoison" "spectrwm" "tfwm" "twm" "wmfs" "xmonad" )

# finds a running wm in list of common wms
function find_wm() {
    for wm in ${wms[@]}; do
        pid=$(pgrep -x -u $USER $wm)
        if [[ "$pid" ]]; then
            echo $wm
            break
        fi
    done
}

# Get info
host="${c5}${USER}${c7}@${c5}$(hostname)${rc}"
os="${c6}OS:${rc}       ${c7}$(lsb_release -i -s)${rc}"
kernel="${c6}KERNEL:${rc}   ${c7}$(uname -sr)${rc}"
uptime="${c6}UPTIME:${rc}   ${c7}$(uptime -p | sed s:'up '::)${rc}"
packages="${c6}PACKAGES:${rc} ${c7}$(pacman -Q | wc -l)${rc}"
shell="${c6}SHELL:${rc}    ${c7}${SHELL}${rc}"
wm="${c6}WM:${rc}       ${c7}$(find_wm)${rc}"

cat << EOF

${c3}      /\\      ${rc}  ${host}
${c3}     /  \\     ${rc}  ${os}
${c3}    /    \\    ${rc}  ${kernel}
${c3}   /  **  \\   ${rc}  ${uptime}
${c3}  /   ${c6}__   \\  ${rc}  ${packages}
${c6} / __/  \\__ \\ ${rc}  ${shell}
${c6}///        \\\\\\${rc}  ${wm}

EOF
