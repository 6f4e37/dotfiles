#!/usr/bin/env bash

# -----------------------------------------------------------------------------
# albumart
# Description: Finds picture in current song's directory and displays using sxiv
# -----------------------------------------------------------------------------
# Requires:
#   ruleset in bspwmrc for sxiv -N "mpd_album_art" or alternative
#   mpc / mpd
#   sxiv
# -----------------------------------------------------------------------------
# Useage:      $ sh ./albumart
# -----------------------------------------------------------------------------

# Set your musicdb
mdb="$HOME/music/"

# Set timeout time
to=5

# current dir
mdir="${mdb}$( mpc -f %file% | head -1 | sed 's:[^/]*$::' )"

# Search for common album art filenames (folder. , back., front.,)
cover=$( ls "${mdir}" | egrep '(\.jpe?g|\.png|\.gif)' | head -n 1 )

# display picture for ${to} seconds in sxiv
timeout -sHUP ${to} sxiv -N "mpd_album_art" -b -s f -g 256x256-100-100 "${mdir}${cover}" 2>/dev/null &
