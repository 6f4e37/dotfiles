#!/usr/bin/env bash

# -----------------------------------------------------------------------------
# scrotw
# Description: Capture a window and add a drop shadow behind it
# -----------------------------------------------------------------------------
# Source:
#   Bemoko: http://blog.bemoko.com/blog/2009/07/01/add-shadow-and-border-to-images-with-imagemagick/
#   Twily: http://twily.info/scrotw#Other
# -----------------------------------------------------------------------------
# Requires:
#   scrot
#   imagemagick
# -----------------------------------------------------------------------------
# Useage:      $ sh ./scrotw filename.png
# -----------------------------------------------------------------------------

name=$(date +'%b%d::%H%M%S').png
scrot ~/pics/scrots/scrotw.tmp.png -sbd 1 || exit 1
convert ~/pics/scrots/scrotw.tmp.png -profile ~/.icc/ISOcoated_v2_300_eci.icc \
    \( +clone -background "rgba(6,6,6,1)" -shadow 75x7+0+0 \) \
    +swap -background "rgba(0,0,0,0)" -layers merge +repage ~/pics/scrots/$name &>/dev/null || exit 1

rm ~/pics/scrots/scrotw.tmp.png

exit 0
